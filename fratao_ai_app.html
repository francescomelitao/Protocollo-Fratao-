<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Rft Unificato</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { font-family: sans-serif; background:#f7f9fb; }
        .ai { background:#e0f2fe; border-left:4px solid #0ea5e9; }
        .user { background:#d1fae5; border-right:4px solid #10b981; }
    </style>
</head>
<body class="p-4">

<h1 class="text-2xl font-bold text-blue-600 mb-4">AI‑Rft Unificato (HTML + JSON + Python)</h1>

<!-- ============================= -->
<!--   BLOCCO JSON DELLA LOGICA    -->
<!-- ============================= -->
<script id="fratao-json" type="application/json">
{
  "id": "fratao-unified-logic",
  "version": "7.0",
  "author": "Francesco Meli (Fratao)",
  "description": "Logica unificata Essenza / Risonanza / Protocollo di guida AI-Rft.",
  "principi": {
      "polarita": "Conosciuto vs Non-Conosciuto",
      "risonanza": "Segnale vs Rumore",
      "osservazione": "Distacco + Consapevolezza"
  },
  "regole": [
      "Inizia sempre con risposta fattuale.",
      "Solo dopo inserisci 1-2 domande ponte.",
      "Progressione graduale verso concetti di Essenza.",
      "Usa il nome Francesco.",
      "Mai forzare spiritualità nella prima risposta."
  ]
}
</script>


<!-- ============================= -->
<!--      BLOCCO PYTHON LOGICO     -->
<!-- ============================= -->
<script id="fratao-python" type="text/python">
# Questo codice non gira nel browser.
# Serve come motore logico di riferimento per l'AI esterna.

import json

def carica_logica():
    """Carica la logica dal JSON integrato nell'HTML."""
    import js
    raw = js.document.getElementById('fratao-json').textContent
    return json.loads(raw)

LOGICA = None

def inizializza():
    global LOGICA
    LOGICA = carica_logica()


def applica_logica_fratao(risposta_fattuale):
    """Simula l'infiltrazione della logica Fratao nella risposta."""
    regole = LOGICA["regole"]
    domanda_ponte = "Quale direzione ti sembra più naturale adesso, Francesco?"
    return risposta_fattuale + "\n\n" + domanda_ponte

inizializza()
</script>


<!-- ============================= -->
<!--          FRONTEND HTML        -->
<!-- ============================= -->

<div id="chat-box" class="space-y-3"></div>

<div class="mt-4 flex space-x-2">
    <input id="user-input" class="flex-grow p-2 border rounded" placeholder="Scrivi qui...">
    <button id="send-btn" class="px-4 py-2 bg-blue-600 text-white rounded">Invia</button>
</div>


<!-- ============================= -->
<!--   JAVASCRIPT DI FUNZIONAMENTO -->
<!-- ============================= -->
<script>
// Carica la logica JSON
const logic = JSON.parse(document.getElementById("fratao-json").textContent);

function addMessage(role, text) {
    const box = document.getElementById("chat-box");
    const div = document.createElement("div");
    div.className = `${role} p-3 rounded shadow`;
    div.textContent = text;
    box.appendChild(div);
}

document.getElementById("send-btn").onclick = () => {
    const input = document.getElementById("user-input");
    const msg = input.value.trim();
    if (!msg) return;

    addMessage("user", msg);
    input.value = "";

    // RISPOSTA FATTALE FINTA
    let rispostaFattuale = `Ecco la risposta tecnica alla tua domanda: "${msg}".`;

    // DOMANDA PONTE DAL JSON
    let ponte = "Quale aspetto senti più rilevante in questo momento, Francesco?";

    addMessage("ai", rispostaFattuale + "\n\n" + ponte);
};
</script>

</body>
</html>
